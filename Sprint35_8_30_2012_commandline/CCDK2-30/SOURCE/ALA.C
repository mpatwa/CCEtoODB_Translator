/* -2 -3 */
/********************************** ALA.C **********************************/
/********************** Processing arrays of numbers ***********************/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
#include <aladefs.h>

/*-------------------------------------------------------------------------*/
BBS_PRIVATE void    ala_binom ( d, c ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
INT     d       ;   /* order of the binomial coefficients */
REAL    *c   ;   /* c[d][d] ; c[k][i]=C(k,i), k<d */
{ 
    INT i, k ; 
    REAL *row, *prev ;
        
    for ( row = c, prev=c-d, k=0 ; k<d ; k++, prev=row, row+=d ) {
        row[0] = 1.0 ;
        row[k] = 1.0 ;
        for ( i=1 ; 2*i<=k ; i++ ) {
            row[i] = prev[i-1] + prev[i] ;
            row[k-i] = row[i] ;
        }
    }
}    


/*-------------------------------------------------------------------------*/
BBS_PRIVATE BOOLEAN ala_overlap ( min0, max0, min1, max1 )
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL min0, max0, min1, max1 ;
{ 
    if ( max0 < min1 - BBS_TOL ) 
        RETURN ( FALSE ) ;
    if ( max1 < min0 - BBS_TOL ) 
        RETURN ( FALSE ) ;
    RETURN ( TRUE ) ;
}    


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL* ala_copy ( a, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a ;
INT d ;
REAL    *b  ;
{
    INT i ;
    for ( i=0 ; i<d ; i++ ) 
        b[i] = a[i] ;
    RETURN ( b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL ala_max_fabs ( a, d ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL    *a ;
INT d ;
{
    INT i ;
    REAL a_max = 0.0 ;

    if ( a == NULL )
        RETURN ( 1.0 ) ;
    for ( i=0 ; i<d ; i++ ) {
        if ( fabs(a[i]) > a_max )
            a_max = fabs(a[i]) ;
    }
    RETURN ( a_max ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_set_zero ( a, d ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL    *a ;
INT d ;
{
    INT i ;
    for ( i=0 ; i<d ; i++ ) 
        a[i] = 0.0 ;
}

/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_min_max ( t0, t1, t_min, t_max ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL t0, t1, *t_min, *t_max ;
{
    if ( t0 < t1 ) {
        *t_min = t0 ;
        *t_max = t1 ;
    }
    else {
        *t_min = t1 ;
        *t_max = t0 ;
    }
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_swap ( a, b, d ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a ;
REAL    *b ;
INT d ;
{
    INT i ;
    REAL c ;

    for ( i=0 ; i<d ; i++ ) {
        c    = b[i] ;
        b[i] = a[i] ;
        a[i] = c    ;
    }
}


#ifdef  SPLINE
/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_add ( a1, a2, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a1, *a2 ;
INT d ;
REAL    *b ;
{
    INT i ;
    for ( i=0 ; i<d ; i++ ) 
        b[i] = a1[i] + a2[i] ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_scale ( a, t, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a ;
REAL    t ;
INT d ;
REAL    *b ;
{
    INT i ;
    for ( i=0 ; i<d ; i++ ) 
        b[i] = t * a[i] ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_addt ( a1, a2, t, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a1, *a2 ;
REAL    t ;
INT d ;
REAL    *b ;
{
    INT i ;
    for ( i=0 ; i<d ; i++ ) 
        b[i] = a1[i] + t * a2[i] ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE void ala_diff ( a, d, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a ;       /* a[d-1] */
INT     d ;
REAL    *b ;       /* b[d-2] */
{
    INT i ;

    for ( i=d-2 ; i>=0 ; i-- ) 
        b[i] = a[i+1] - a[i] ;
}

/*-------------------------------------------------------------------------*/
BBS_PRIVATE BOOLEAN ala_diff_small ( a1, a2, d, tol ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                         !!!!!!!!*/
/*!!!!!!!! (C) Copyright 1989 - 1995 Building Block Software  !!!!!!!!*/
/*!!!!!!!!                    All rights reserved                  !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/

REAL    *a1, *a2 ;       /* a1[d] */
INT     d ;
REAL    tol ;       
{
    INT i ;

    for ( i=0 ; i<d ; i++ ) 
        if ( fabs ( a1[i] - a2[i] ) > tol ) 
            RETURN ( FALSE ) ;
    RETURN ( TRUE ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE BOOLEAN ala_coinc ( a1, a2, n ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL    *a1, *a2 ;  
INT     n ;
{
    INT i ;
    for ( i = 0 ; i < n ; i++ ) {
        if ( !IS_SMALL(a1[i]-a2[i]) )
            RETURN ( FALSE ) ;
    }
    RETURN ( TRUE ) ;
}

#endif  /*SPLINE*/

