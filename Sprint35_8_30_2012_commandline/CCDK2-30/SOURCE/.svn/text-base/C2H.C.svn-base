/* -2 -3 */
/********************************** C2H.C **********************************/
/********************* 2d homogeneous vector geometry **********************/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
#include <bbsdefs.h>
#ifdef  SPLINE
#include <c2hdefs.h>
#include <c2vmcrs.h>
#include <c2hmcrs.h>

/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_set_zero ( a ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a ;
{
    a[0] = 0.0 ;
    a[1] = 0.0 ;
    a[2] = 1.0 ;
    RETURN ( a ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_set ( x, y, w, a ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL x, y, w ;
HPT2 a ;
{
    a[0] = x ;
    a[1] = y ;
    a[2] = w ;
    RETURN ( a ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_copy ( a, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a, b ;
{
    b[0] = a[0] ;
    b[1] = a[1] ;
    b[2] = a[2] ;
    RETURN ( b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_diff ( a, b, c ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a, b ;
PT2 c ;
{
    c[0] = a[0] * b[2] - b[0] * a[2] ;
    c[1] = a[1] * b[2] - b[1] * a[2] ;
    RETURN ( c ) ;
}

/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_hdiff ( a, b, c ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a, b ;
PT2 c ;
{
    c[0] = a[0] / a[2] - b[0] / b[2] ;
    c[1] = a[1] / a[2] - b[1] / b[2] ;
    RETURN ( c ) ;
}

/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_sub ( a, v, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a ;
PT2 b, v ;
{
    b[0] = a[0] - v[0] * a[2] ;
    b[1] = a[1] - v[1] * a[2] ;
    RETURN ( b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL*   c2h_mirror ( a, origin, normal, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a, b ;
PT2 origin, normal ;
{
    PT2 a1 ;
    REAL dot ;

    C2H_SUB ( a, origin, a1 ) ;
    dot = -2.0 * C2V_DOT ( a1, normal ) ;
    C2V_ADDT ( a, normal, dot, b ) ;
    b[2] = a[2] ;
    RETURN ( b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL* c2h_pt_hpt ( a, b ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                   All rights reserved                    !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
PT2 a  ;
HPT2 b  ; 
{
    C2V_COPY ( a, b ) ;
    b[2] = 1.0 ;
    RETURN ( b ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE REAL* c2h_hpt_pt ( b, a ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                   All rights reserved                    !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 b ;
PT2 a ;
{
    if ( IS_SMALL(b[2]) )
        RETURN ( NULL ) ;
    a[0] = b[0]/b[2] ;
    a[1] = b[1]/b[2] ;
    RETURN ( a ) ;
}


/*-------------------------------------------------------------------------*/
BBS_PRIVATE BOOLEAN c2h_ident_pts ( a1, a2 ) 
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!      (C) Copyright 1989 - 1995 Building Block Software   !!!!!!!*/
/*!!!!!!!!                   All rights reserved                    !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
HPT2 a1, a2 ;
{
    RETURN ( IS_SMALL ( a1[0] * a2[2] - a2[0] * a1[2] ) &&
             IS_SMALL ( a1[1] * a2[2] - a2[1] * a1[2] ) ) ;
}

#endif  /*SPLINE*/

