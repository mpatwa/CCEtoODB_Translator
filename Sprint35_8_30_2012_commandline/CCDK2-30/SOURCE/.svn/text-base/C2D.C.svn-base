/* -2 -3 */
/******************************* C2D.C **********************************/
/********** Two-dimensional curve construction routines *****************/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
#include <c2gdefs.h>
#include <c2ldefs.h>
#include <c2ndefs.h>
#include <c2pdefs.h>
#include <c2zdefs.h>
#include <c2cdefs.h>
#include <c2ddefs.h>
#include <c2dpriv.h>
#include <c2mem.h>
#include <c2vmcrs.h>
#include <dmbdefs.h>

STATIC      void            c2d_clear __(( C2_CURVE )) ;
GLOBAL      INT             C2_CURVE_BUF_SIZE=0 ;
GLOBAL      INT             C2_CURVES_NUMBER=0 ;
GLOBAL      C2_CURVE        *C2_CURVE_BUFFER ;

/*----------------------------------------------------------------------*/
BBS_PRIVATE void c2d_set_buf_size ( n ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
INT n ;
{
    C2_CURVE_BUF_SIZE = n ;
}


/*----------------------------------------------------------------------*/
BBS_PRIVATE C2_CURVE c2d_alloc_curve ( ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
{
    RETURN ( (C2_CURVE)dmb_malloc ( (ANY**)&C2_CURVE_BUFFER, C2_CURVE_BUF_SIZE, 
        &C2_CURVES_NUMBER, sizeof(C2_CURVE_S) ) ) ;
}


/*----------------------------------------------------------------------*/
BBS_PRIVATE C2_CURVE c2d_curve () 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
{
    C2_CURVE curve ;

    curve = c2d_alloc_curve () ;
    if ( curve == NULL ) 
        RETURN ( NULL ) ;
    C2_CURVE_LINE(curve) = NULL ;
    C2_CURVE_TYPE(curve) = C2_LINE_TYPE ;
    RETURN ( curve ) ;
}


/*----------------------------------------------------------------------*/
STATIC void c2d_clear ( curve ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
C2_CURVE curve ;
{
    if ( curve == NULL )
        RETURN ;
    if ( C2_CURVE_IS_LINE(curve) ) 
        c2l_free ( C2_CURVE_LINE(curve) ) ;
    else if ( C2_CURVE_IS_ARC(curve) ) 
        c2g_free ( C2_CURVE_ARC(curve) ) ;
    else if ( C2_CURVE_IS_ZERO_ARC(curve) ) 
        c2z_free ( C2_CURVE_ZERO_ARC(curve) ) ;
    else if ( C2_CURVE_IS_PCURVE(curve) ) 
        c2p_free ( C2_CURVE_PCURVE(curve) ) ;
#ifdef  SPLINE
    else 
        c2n_free_nurb ( C2_CURVE_NURB(curve) ) ;
#endif  /* SPLINE */
    C2_CURVE_LINE(curve) = NULL ;
}


/*-------------------------------------------------------------------------*/
BBS_PUBLIC void c2d_free_curve ( curve )
/*-------------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                          !!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                    All rights reserved                   !!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
C2_CURVE curve ;     /* Curve to be freed, can be NULL */
{
    dmb_free ( curve, (ANY**)&C2_CURVE_BUFFER, C2_CURVE_BUF_SIZE, 
        &C2_CURVES_NUMBER, ( PF_ACTION ) c2d_clear ) ;
}


/*----------------------------------------------------------------------*/
BBS_PUBLIC PT2 *c2d_point ( x, y ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
REAL x, y ;
{
    REAL *pt ;
     
    pt = MALLOC ( 2, REAL ) ;
    if ( pt != NULL )
        C2V_SET ( x, y, pt ) ;
    RETURN ( (PT2*)pt ) ;
}


/*----------------------------------------------------------------------*/
BBS_PUBLIC void c2d_free_point ( pt ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
PT2 *pt ;
{
    FREE ( *pt ) ;
}


/*----------------------------------------------------------------------*/
BBS_PUBLIC C2_INT_REC c2d_create_int_rec () 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
{
    C2_INT_REC int_rec = C2_ALLOC_INT_REC ;
    RETURN ( int_rec ) ;
}    


/*----------------------------------------------------------------------*/
BBS_PUBLIC void c2d_free_int_rec ( int_rec ) 
/*----------------------------------------------------------------------*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
/*!!!!!!!!                                                      !!!!!!!!*/
/*!!!!!!!!     (C) Copyright 1989 - 1995 Building Block Software!!!!!!!!*/
/*!!!!!!!!                   All rights reserved                !!!!!!!!*/
/*!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!*/
C2_INT_REC int_rec ;
{
    C2_FREE_INT_REC ( int_rec ) ;
}    

